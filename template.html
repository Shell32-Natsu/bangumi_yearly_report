<html>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bangumi Report for {{ user_id }}</title>
<style>
  body {font-family: sans-serif; background: #1c1c1c; color: white; margin: 0;}
  .main {width: 80%; margin: auto; padding: 0}
  .main h2 {width: 100%; float: left}
  body ul {list-style-type: none; padding: 0}
  body ul li {float: left; width: 12.5%;}
  body.overview ul li {width: 6.25%;}
  div.image-wrapper {padding-top: 140%;}
  div.image-wrapper img {width: 100%; top: 0; height: 100%; position: absolute;}
  body h1 {text-align: center}
  .type-tag {
    display: inline-block;
    margin: 0 2px;
    padding: 0 0.2rem;
    font-size: 0.7rem;
    color: white;
    background-color: #ff5500;
    border: 1px solid transparent;
    border-radius: 0.2rem;
    opacity: 0.8;
    vertical-align: top;
  }
  .type-anime {background-color: #f5222d;}
  .type-book {background-color: #fa8c16;}
  .type-music {background-color: #52c41a;}
  .type-game {background-color: #1890ff;}
  .type-real {background-color: #722ed1;}
  .item-title {
    display: none;
    position: absolute;
    width: 100%;
    min-width: 72px;
    z-index: 1;
    bottom: 0;
    font-size: 1rem;
    background: linear-gradient(to top, #000000b8, #0101016e 75%, #ffffff00);
    color: white;
    padding-top: 1rem;
  }
  .item-title a {
    color: white;
    text-decoration: none;
  }
  .item-box {position: relative;}
  .item-box:hover {box-shadow: 0 0 10px 5px #4c4c4c; z-index: 1;}
  .item-box:hover > .item-title {display: block;}
  .item-image {position: relative;}
  .item-month-label {
    position: absolute;
    width: 100%;
    z-index: 1;
    top: 0;
    font-size: 1.5rem;
    background: linear-gradient(to bottom, #000000b8, #0101016e 75%, #ffffff00);
    color: white;
  }
  .item-month-label span {font-size: 3rem;}
  .star {font-size: 0.7rem;}
  .config {
    display: block;
    position: absolute;
    right: 0;
    top: 0;
    margin: 5px;
    color: darkgray;
    font-size: 0.7rem;
    text-align: center;
  }
  .config-menu {display: block; opacity: 0.7;}
  .config:hover .config-menu {display: none;}
  .config-content {display: none;}
  .config:hover .config-content {display: block;}
  .config-btn {
    display: block;
    padding: 1px 3px;
    margin-bottom: 3px;
    color: #d8d8d8;
    text-shadow: 0px 1px 2px #444;
    text-decoration: none;
    cursor: pointer;
    border: 1px solid #6e6e6e;
    background-image: linear-gradient(to bottom, #767677 0%, #747474 100%);
    background-repeat: repeat-x;
    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#ff767677', endColorstr='#ff747474', GradientType=0);
    -webkit-box-shadow: 0 1px 2px #393939, inset 0 1px 1px #7c7c7c;
    -moz-box-shadow: 0 1px 2px #393939, inset 0 1px 1px #7c7c7c;
    box-shadow: 0 1px 2px #393939, inset 0 1px 1px #7c7c7c;
    -moz-border-radius: 4px;
    -webkit-border-radius: 4px;
    border-radius: 4px;
  }
  .config-btn.enabled {
    color: #FFF;
    background-image: linear-gradient(to bottom, #397de8 0%, #3072dc 100%);
    background-repeat: repeat-x;
  }
  #github-link {bottom: 0; padding: 0.5rem; clear: both; text-align: center;}
  #github-link img {margin: auto; height: 2rem;}
  @media (max-width: 1300px) {
    .main {width: 100%;}
  }
  @media (max-width: 800px) {
    body ul li {width: 33.333333%;}
    body.overview ul li {width: 10%; min-width: 55px;}
    div.image-wrapper {height: 0; width: 100%; padding-top: 140%;}
  }
</style>
<body>

<h1>
  Bangumi Report for {{ user_id }}
  {% if type != 'all' %}
  <span class="type-tag type-{{type}}">
    {{type}}
  </span>
  {% endif %}
</h1>
<div id="config" class="config">
  <div class="config-menu">
    <img width="20px" style="filter: invert(1)" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/PjwhRE9DVFlQRSBzdmcgIFBVQkxJQyAnLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4nICAnaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkJz48c3ZnIGhlaWdodD0iMzJweCIgaWQ9IkxheWVyXzEiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDMyIDMyOyIgdmVyc2lvbj0iMS4xIiB2aWV3Qm94PSIwIDAgMzIgMzIiIHdpZHRoPSIzMnB4IiB4bWw6c3BhY2U9InByZXNlcnZlIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj48cGF0aCBkPSJNNCwxMGgyNGMxLjEwNCwwLDItMC44OTYsMi0ycy0wLjg5Ni0yLTItMkg0QzIuODk2LDYsMiw2Ljg5NiwyLDhTMi44OTYsMTAsNCwxMHogTTI4LDE0SDRjLTEuMTA0LDAtMiwwLjg5Ni0yLDIgIHMwLjg5NiwyLDIsMmgyNGMxLjEwNCwwLDItMC44OTYsMi0yUzI5LjEwNCwxNCwyOCwxNHogTTI4LDIySDRjLTEuMTA0LDAtMiwwLjg5Ni0yLDJzMC44OTYsMiwyLDJoMjRjMS4xMDQsMCwyLTAuODk2LDItMiAgUzI5LjEwNCwyMiwyOCwyMnoiLz48L3N2Zz4=" />
  </div>
  <div class="config-content">
    <a id="config-overview" class="config-btn disabled" onclick="toggle()">概览模式</a>
    <a id="action-shot" class="config-btn" onclick="shot()">截图</a>
  </div>
</div>
{% for year_list in image_list %}
<div class="main">
  {% if year_list %}
  <h2>{{year_list[0]['marked_date'][0:4]}}</h2>
  {% endif %}
  <ul>
  {% for image in year_list %}
    <li>
      <div class="item-box">
        {% if image['label'] != 0 %}
        <div class="item-month-label">
          <span>{{image['label']}}</span>月
        </div>
        {% endif %}

        <div class="item-image">
            <a href="{{ image['link'] }}" target="_blank">
              <div class="image-wrapper">
                <img src="{{ image['image_url'] }}">
              </div>

            </a>
        </div>

        <div class="item-title">
          {% if type == 'all' %}
          <span class="type-tag type-{{image['type']}}">
            {{image['type']}}
          </span><br>
          {% endif %}
          <a href="{{ image['link'] }}" target="_blank">{{image['title']}}</a><br>
          <small>
            {{image['marked_date']}}&nbsp;

            {% if image['star'] >= 0 %}
            {{image['star']}}&#x2605;
            {#<span class="star">
              {%- for i in range(0, image['star'], 2) %}
                {%- if image['star'] - i < 2 %}&#x2606;{%- else %}&#x2605;{%- endif %}
              {%- endfor %}
            </span>#}
            {% endif %}
          </small>
        </div>
      </div>
    </li>
    {% endfor %}
  </ul>
</div>
{% endfor %}
<div id="github-link">
  <a href="https://github.com/Shell32-Natsu/bangumi_yearly_report" target="_blank" title="GitHub">
    <img src="data:image/svg+xml;utf8;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pgo8IS0tIEdlbmVyYXRvcjogQWRvYmUgSWxsdXN0cmF0b3IgMTYuMC4wLCBTVkcgRXhwb3J0IFBsdWctSW4gLiBTVkcgVmVyc2lvbjogNi4wMCBCdWlsZCAwKSAgLS0+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiBpZD0iQ2FwYV8xIiB4PSIwcHgiIHk9IjBweCIgd2lkdGg9IjE2cHgiIGhlaWdodD0iMTZweCIgdmlld0JveD0iMCAwIDQzOC41NDkgNDM4LjU0OSIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgNDM4LjU0OSA0MzguNTQ5OyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+CjxnPgoJPHBhdGggZD0iTTQwOS4xMzIsMTE0LjU3M2MtMTkuNjA4LTMzLjU5Ni00Ni4yMDUtNjAuMTk0LTc5Ljc5OC03OS44QzI5NS43MzYsMTUuMTY2LDI1OS4wNTcsNS4zNjUsMjE5LjI3MSw1LjM2NSAgIGMtMzkuNzgxLDAtNzYuNDcyLDkuODA0LTExMC4wNjMsMjkuNDA4Yy0zMy41OTYsMTkuNjA1LTYwLjE5Miw0Ni4yMDQtNzkuOCw3OS44QzkuODAzLDE0OC4xNjgsMCwxODQuODU0LDAsMjI0LjYzICAgYzAsNDcuNzgsMTMuOTQsOTAuNzQ1LDQxLjgyNywxMjguOTA2YzI3Ljg4NCwzOC4xNjQsNjMuOTA2LDY0LjU3MiwxMDguMDYzLDc5LjIyN2M1LjE0LDAuOTU0LDguOTQ1LDAuMjgzLDExLjQxOS0xLjk5NiAgIGMyLjQ3NS0yLjI4MiwzLjcxMS01LjE0LDMuNzExLTguNTYyYzAtMC41NzEtMC4wNDktNS43MDgtMC4xNDQtMTUuNDE3Yy0wLjA5OC05LjcwOS0wLjE0NC0xOC4xNzktMC4xNDQtMjUuNDA2bC02LjU2NywxLjEzNiAgIGMtNC4xODcsMC43NjctOS40NjksMS4wOTItMTUuODQ2LDFjLTYuMzc0LTAuMDg5LTEyLjk5MS0wLjc1Ny0xOS44NDItMS45OTljLTYuODU0LTEuMjMxLTEzLjIyOS00LjA4Ni0xOS4xMy04LjU1OSAgIGMtNS44OTgtNC40NzMtMTAuMDg1LTEwLjMyOC0xMi41Ni0xNy41NTZsLTIuODU1LTYuNTdjLTEuOTAzLTQuMzc0LTQuODk5LTkuMjMzLTguOTkyLTE0LjU1OSAgIGMtNC4wOTMtNS4zMzEtOC4yMzItOC45NDUtMTIuNDE5LTEwLjg0OGwtMS45OTktMS40MzFjLTEuMzMyLTAuOTUxLTIuNTY4LTIuMDk4LTMuNzExLTMuNDI5Yy0xLjE0Mi0xLjMzMS0xLjk5Ny0yLjY2My0yLjU2OC0zLjk5NyAgIGMtMC41NzItMS4zMzUtMC4wOTgtMi40MywxLjQyNy0zLjI4OWMxLjUyNS0wLjg1OSw0LjI4MS0xLjI3Niw4LjI4LTEuMjc2bDUuNzA4LDAuODUzYzMuODA3LDAuNzYzLDguNTE2LDMuMDQyLDE0LjEzMyw2Ljg1MSAgIGM1LjYxNCwzLjgwNiwxMC4yMjksOC43NTQsMTMuODQ2LDE0Ljg0MmM0LjM4LDcuODA2LDkuNjU3LDEzLjc1NCwxNS44NDYsMTcuODQ3YzYuMTg0LDQuMDkzLDEyLjQxOSw2LjEzNiwxOC42OTksNi4xMzYgICBjNi4yOCwwLDExLjcwNC0wLjQ3NiwxNi4yNzQtMS40MjNjNC41NjUtMC45NTIsOC44NDgtMi4zODMsMTIuODQ3LTQuMjg1YzEuNzEzLTEyLjc1OCw2LjM3Ny0yMi41NTksMTMuOTg4LTI5LjQxICAgYy0xMC44NDgtMS4xNC0yMC42MDEtMi44NTctMjkuMjY0LTUuMTRjLTguNjU4LTIuMjg2LTE3LjYwNS01Ljk5Ni0yNi44MzUtMTEuMTRjLTkuMjM1LTUuMTM3LTE2Ljg5Ni0xMS41MTYtMjIuOTg1LTE5LjEyNiAgIGMtNi4wOS03LjYxNC0xMS4wODgtMTcuNjEtMTQuOTg3LTI5Ljk3OWMtMy45MDEtMTIuMzc0LTUuODUyLTI2LjY0OC01Ljg1Mi00Mi44MjZjMC0yMy4wMzUsNy41Mi00Mi42MzcsMjIuNTU3LTU4LjgxNyAgIGMtNy4wNDQtMTcuMzE4LTYuMzc5LTM2LjczMiwxLjk5Ny01OC4yNGM1LjUyLTEuNzE1LDEzLjcwNi0wLjQyOCwyNC41NTQsMy44NTNjMTAuODUsNC4yODMsMTguNzk0LDcuOTUyLDIzLjg0LDEwLjk5NCAgIGM1LjA0NiwzLjA0MSw5LjA4OSw1LjYxOCwxMi4xMzUsNy43MDhjMTcuNzA1LTQuOTQ3LDM1Ljk3Ni03LjQyMSw1NC44MTgtNy40MjFzMzcuMTE3LDIuNDc0LDU0LjgyMyw3LjQyMWwxMC44NDktNi44NDkgICBjNy40MTktNC41NywxNi4xOC04Ljc1OCwyNi4yNjItMTIuNTY1YzEwLjA4OC0zLjgwNSwxNy44MDItNC44NTMsMjMuMTM0LTMuMTM4YzguNTYyLDIxLjUwOSw5LjMyNSw0MC45MjIsMi4yNzksNTguMjQgICBjMTUuMDM2LDE2LjE4LDIyLjU1OSwzNS43ODcsMjIuNTU5LDU4LjgxN2MwLDE2LjE3OC0xLjk1OCwzMC40OTctNS44NTMsNDIuOTY2Yy0zLjksMTIuNDcxLTguOTQxLDIyLjQ1Ny0xNS4xMjUsMjkuOTc5ICAgYy02LjE5MSw3LjUyMS0xMy45MDEsMTMuODUtMjMuMTMxLDE4Ljk4NmMtOS4yMzIsNS4xNC0xOC4xODIsOC44NS0yNi44NCwxMS4xMzZjLTguNjYyLDIuMjg2LTE4LjQxNSw0LjAwNC0yOS4yNjMsNS4xNDYgICBjOS44OTQsOC41NjIsMTQuODQyLDIyLjA3NywxNC44NDIsNDAuNTM5djYwLjIzN2MwLDMuNDIyLDEuMTksNi4yNzksMy41NzIsOC41NjJjMi4zNzksMi4yNzksNi4xMzYsMi45NSwxMS4yNzYsMS45OTUgICBjNDQuMTYzLTE0LjY1Myw4MC4xODUtNDEuMDYyLDEwOC4wNjgtNzkuMjI2YzI3Ljg4LTM4LjE2MSw0MS44MjUtODEuMTI2LDQxLjgyNS0xMjguOTA2ICAgQzQzOC41MzYsMTg0Ljg1MSw0MjguNzI4LDE0OC4xNjgsNDA5LjEzMiwxMTQuNTczeiIgZmlsbD0iI2ZmZmZmZiIvPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+Cjwvc3ZnPgo=" />
  </a>
</div>

<div id="shot">
  <img alt="Close" class="close" onclick="closeShot()"
       src="data:image/svg+xml;base64,PHN2ZyBmaWxsPSIjZmZmZmZmIiBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxwYXRoIGQ9Ik0xOSA2LjQxTDE3LjU5IDUgMTIgMTAuNTkgNi40MSA1IDUgNi40MSAxMC41OSAxMiA1IDE3LjU5IDYuNDEgMTkgMTIgMTMuNDEgMTcuNTkgMTkgMTkgMTcuNTkgMTMuNDEgMTJ6Ii8+CiAgICA8cGF0aCBkPSJNMCAwaDI0djI0SDB6IiBmaWxsPSJub25lIi8+Cjwvc3ZnPgo=" />
  <div id="canvas-container"></div>
</div>

<style type="text/css">
  #shot {
    display: none;
    background: rgba(0, 0, 0, 0.5);
    position: fixed;
    top: 0;
    left: 0;
    z-index: 99999998;
    width: 100%;
    height: 100%;
  }
  #shot img.close {
    position: absolute;
    right: 20px;
    top: 20px;
    cursor: pointer;
  }
  #canvas-container {overflow-y: scroll; max-height: 100%;}
  #shot canvas {
    top: 0;
    left: 0;
    opacity: 0;
    transform: scale(0);
    z-index: 99999999;
    transition: transform 0.3s cubic-bezier(0.42, 0, 0.58, 1),opacity 0.3s cubic-bezier(0.42, 0, 0.58, 1),-webkit-transform 0.3s cubic-bezier(0.42, 0, 0.58, 1);
  }
</style>

<script type="text/javascript">
  function toggle() {
    var confEl = document.getElementById('config-overview');
    if (!confEl) {return;}
    if (confEl.classList.contains('enabled')) {
      document.body.classList.remove('overview');
      confEl.classList.remove('enabled');
      confEl.classList.add('disabled');
    } else {
      document.body.classList.add('overview');
      confEl.classList.add('enabled');
      confEl.classList.remove('disabled');
    }
  }
</script>

<script type="text/javascript">
  var hideElements = ['github-link', 'config'];
  function shot() {
    if (document.getElementById('html2canvas')) {
      startShot();
    } else {
      var script = document.createElement('script');
      script.id = 'html2canvas';
      script.src = "https://html2canvas.hertzen.com/dist/html2canvas.min.js";
      script.onload = startShot;
      document.body.appendChild(script);
    }
  }
  function startShot() {
    hideElements.forEach(function(id) {
      document.getElementById(id).style.opacity = '0';
    })
    html2canvas(document.body, {'allowTaint': true, 'loggin': false}).then(function(canvas) {
      document.body.style.overflowY = 'hidden';
      document.getElementById('shot').style.display = 'block';
      document.getElementById('canvas-container').appendChild(canvas);
      setTimeout(function() {
        canvas.id = 'shot-canvas';
        canvas.style.opacity = '1';
        canvas.style.transform = 'scale(0.8)';
        hideElements.forEach(function(id) {
          document.getElementById(id).style.opacity = '';
        })
      }, 100)
    });
  }
  function closeShot() {
    document.getElementById('shot').style.display = 'none';
    document.body.style.overflowY = '';
    setTimeout(function() {
      document.getElementById('shot-canvas').remove();
    }, 100)
  }
</script>
</body>
</html>
